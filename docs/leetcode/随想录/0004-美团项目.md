# 4-工单系统扩展字段变更统计 

## 项目

​       在工单系统中，每个工单可以关联**一个或多个扩展字段**，这些字段包括**文本框、选择器、表格**等特定组件。在工单处理过程中，扩展字段可能会随着**工单的流转发生变更**，需要**自动统计指定字段在指定时间**的变更次数及**其变更前后的内容**。独立完成了该需求的设计文档、代码编写、单测和上线。

技术栈：Spring Boot、Mybatis、Squirrel(Redis)、Mafka(Kafka)、Cerberus

- **配置台：**
  - 允许增删指定的统计字段，统计字段的ID保存在缓存中以便快速查询。
  - 通过数据订阅统计字段表的Binlog，并使用Mafka生产者发送Binlog消息。
  - 在另一个服务中消费消息并存入缓存，实现数据库与缓存的同步。
- **运行态：**
  - 通过定时任务自动统计变更记录，提供详细变更查询接口。可以根据日期、字段名称或ID查询对应字段的变更次数。
  - 订阅工单字段表的Binlog，通过Mafka消费Binlog消息统计变更内容，通过缓存快速判断是否为需要统计的字段。
  - 使用Cerberus解决统计字段变更记录并发安全问题。根据字段ID和日期作为key，锁住对应的行记录，完成字段变更的统计。



需求项目收获：了解了真实业务需求和代码规范问题。更加了解了数据一致性问题，以及MQ以及分布式锁的使用场景。



## 做的事情

负责工单系统中对外RPC接口的编写，如工单扩展字段、数据对象等功能的CRUD接口。

负责修复一些线上问题的修复，如NPE，监控埋点覆盖等。

负责一些小工具的开发。如工单侧数据对象换绑查询工具等。

完成工单侧架构梳理，B端的设计架构、工单建单流程等文档梳理

独立完成工单系统扩展字段变更统计需求的设计文档、代码编写、单测和上线。

实习收获：熟悉了企业JAVA后端开发流程，